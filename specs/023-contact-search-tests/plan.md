# Implementation Plan: Contact Search Tests

**Branch**: `023-contact-search-tests` | **Date**: 2026-02-28 | **Spec**: [spec.md](spec.md)
**Input**: Feature specification from `/specs/023-contact-search-tests/spec.md`

## Summary

Create comprehensive tests for `POST /contacts/v2/search` covering all key-exclusion permutations of the request fixture (optional fields succeed when omitted, required fields fail when omitted, extra fields are rejected). Add field-level response assertions against the mock fixture. Regenerate `html/progress.html` to reflect completed endpoint status.

## Technical Context

**Language/Version**: Python 3.11+ (existing SDK)
**Primary Dependencies**: pydantic>=2.0, requests (existing SDK deps — no new dependencies)
**Storage**: Filesystem (fixture JSON files in `tests/fixtures/` and `tests/fixtures/requests/`)
**Testing**: pytest (non-live: `pytest -m "not live"`)
**Target Platform**: Python SDK (pip-installable library)
**Project Type**: single
**Constraints**: No model changes; test-only + progress regeneration

## Constitution Check

*GATE: Must pass before Phase 0 research. Re-check after Phase 1 design.*

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Pydantic Model Fidelity | N/A | No model changes — tests verify existing models |
| II. Example-Driven Fixture Capture | N/A | No new fixtures — tests use existing request fixture and mock |
| III. Four-Way Harmony | PASS | Tests are the "Fixture & Test" leg — strengthening coverage of existing endpoint |
| IV. Swagger-Informed, Reality-Validated | N/A | No new API surface |
| V. Endpoint Status Tracking | PASS | Progress report regenerated as deliverable |
| VI. Documentation Completeness | N/A | No new public API surface |
| VIII. Phase-Based Context Recovery | PASS | Single commit with all test artifacts |
| IX. Endpoint Input Validation | PASS | Tests verify `extra="forbid"` and required field enforcement |

No violations. No complexity tracking needed.

## Project Structure

### Documentation (this feature)

```text
specs/023-contact-search-tests/
├── plan.md              # This file
├── research.md          # Test strategy decisions
├── data-model.md        # Models under test (reference)
├── quickstart.md        # 3-step verification
├── contracts/
│   └── test-contract.md # Test surface definition
└── checklists/
    └── requirements.md  # Spec quality checklist
```

### Source Code (repository root)

```text
tests/
├── models/
│   ├── test_contact_search.py    # CREATE — all new tests for this feature
│   ├── test_contact_models.py    # REFERENCE — existing fixture validation
│   └── test_request_fixtures.py  # REFERENCE — existing parametrized request tests
├── fixtures/
│   ├── requests/
│   │   └── ContactSearchRequest.json       # REFERENCE — request fixture (input for permutations)
│   └── mocks/
│       └── SearchContactEntityResult.json  # REFERENCE — response mock (input for assertions)
└── conftest.py                             # REFERENCE — load_request_fixture, require_fixture helpers

html/
└── progress.html            # REGEN — regenerated by scripts/generate_progress.py

scripts/
└── generate_progress.py     # REFERENCE — run to regenerate progress.html
```

**Structure Decision**: Existing single-project layout. One new file (`test_contact_search.py`), one regenerated file (`progress.html`), everything else is reference.

## Constitution Re-Check (Post-Design)

| Principle | Status | Notes |
|-----------|--------|-------|
| I. Pydantic Model Fidelity | N/A | No model changes |
| II. Example-Driven Fixture Capture | N/A | No new fixtures |
| III. Four-Way Harmony | PASS | Test coverage strengthened for existing endpoint |
| IV. Swagger-Informed, Reality-Validated | N/A | No new API surface |
| V. Endpoint Status Tracking | PASS | progress.html regenerated |
| VI. Documentation Completeness | N/A | No new public surface |
| VIII. Phase-Based Context Recovery | PASS | All artifacts committed together |
| IX. Endpoint Input Validation | PASS | Permutation tests verify request boundary validation |

No violations. No complexity tracking needed.
